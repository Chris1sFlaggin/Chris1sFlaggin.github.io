---
layout: single
title: "My personal NAS!"
date: 2025-10-19
categories: Projects
---
> ##### Disclaimer:
> Questa guida è a scopo puramente educativo.
---
# Il progetto

## L’intuizione

L’altro giorno ero in università. Tra una lezione in cui la concentrazione era ormai un miraggio e un’altra che sembrava non finire mai, mi è venuta un’idea:
**“Perché non ho una NAS in casa?!”**

Così, mentre cercavo di sembrare ancora minimamente attento, ho iniziato a pensare a cosa potrei farci. La prima idea è stata un **proxy cache** — ottimo progetto, e sicuramente lo realizzerò in futuro — ma non era quello che cercavo in quel momento.

Volevo qualcosa di **più pratico e visivamente utile**, qualcosa che potesse servire **anche ai miei genitori**, non solo a me e alle mie sperimentazioni tecniche.

---

## L’idea

Dopo qualche minuto di brainstorming, ho buttato giù due direzioni principali:

* ☁️ **Un cloud personale** con [Immich](https://immich.app)
  Perfetto per gestire foto e video di famiglia, accessibile da qualsiasi dispositivo e con il controllo totale dei dati.
  Niente più dipendenza da Google Photos o iCloud — tutto in casa, tutto sotto il mio NAS.

* 🔁 **Un reverse proxy** per accedere a contenuti limitati sulle **smart TV**
  Vi lascio immaginare.

---

## Componenti 

### Raspberry Pi 3b
[![Raspberry Pi 3b](https://m.media-amazon.com/images/I/91zSu44+34L.jpg)](https://www.amazon.it/Raspberry-PI-Model-Scheda-madre/dp/B01CD5VC92)
>(clicca sull'immagine per ottenere link)
### Custodia
[![3.5" Screen Case](https://m.media-amazon.com/images/I/61VWMWUQ-pL._AC_UF1000,1000_QL80_.jpg)](https://www.amazon.it/-/en/Raspberry-Supports-Raspbian-RetroPie-Multi-System/dp/B07NTH1JWH)
>(clicca sull'immagine per ottenere link)

---

## SetUp

### 1. SetUp reverse proxy 

#### 1.1. Squid
SSH sul raspberry e digita i seguenti comandi per installare *squid*, un proxy server che può modificare gli header HTML.
```bash
# installa squid
sudo apt install squid -y
# backup file conf
sudo mv /etc/squid/squid.conf /etc/squid/squid.conf.bak
# modifica file conf
sudo nano /etc/squid/squid.conf
```

Vi lascio il link al mio file funzionante:
[Link al mio file](https://github.com/Chris1sFlaggin/NAS/blob/main/squid.conf)

```bash
# applica le modifiche e controlla lo stato
sudo systemctl restart squid
sudo systemctl enable squid
sudo systemctl status squid
```
>Verifica che lo stato sia Active: active (running).

#### 1.2. Nginx
```bash
# installa nginx
sudo apt install nginx -y
# rimuovi file conf default
sudo rm -f /etc/nginx/sites-enabled/default
# crea nuovo file conf
sudo nano /etc/nginx/sites-available/tv-proxy
```

Anche qui lascio il link al mio file funzionante:
[Link al mio file](https://github.com/Chris1sFlaggin/NAS/blob/main/tv-proxy)

```bash
# crea un symlink dal tuo file di configurazione al directory sites-enabled.
sudo ln -s /etc/nginx/sites-available/tv-proxy /etc/nginx/sites-enabled/
# verifica la sintassi del tuo file conf
sudo nginx -t
```

```bash
# applica le modifiche
sudo systemctl restart nginx
sudo systemctl enable nginx
sudo systemctl status nginx
```
>Verifica che lo stato sia Active: active (running).

### 2. SetUp immich 

#### 2.1. Download immich 
Per la memoria io ho montato un hard disk.
Immich consiglia il metodo backup 3-2-1, per il quale sto aspettando l'hardware necessario (un altro hard disk).
```bash
# crea una cartella e muoviti all'interno
mkdir ./immich-app
cd ./immich-app
# scarica docker-compose.yml e .env
wget -O docker-compose.yml https://github.com/immich-app/immich/releases/latest/download/docker-compose.yml
wget -O .env https://github.com/immich-app/immich/releases/latest/download/example.env
# personalizza il file .env
nano .env
```

#### 2.2. Run immich 
Per installare docker: [Docker installation guide](https://docs.docker.com/engine/install/ubuntu/)
```bash
# runna il docker
docker compose up -d
```
Prosegui dalla gui web: [http://<IP>:2283](http://IP:2283).

> ##### ATTENZIONE:
> Io ho avuto dei problemi con immich per colpa delle caratteristiche del mio raspberry e ho cancellato dal docker-compose le righe inerenti al container immich_machine_learning e ho creato un file swap in modo da alleggerire la ram leggermente.

#### 2.3. SetUp external VPN
Per rendere il mio cloud raggiungibile anche fuori casa ho scelto [Tailscale](tailscale.com) per creare una vpn, servizio che consiglio per velocità e intuitività.

### 3. Visualizzatore a schermo

Ho creato uno script di python che crea un'immagine dello stato ogni 5 secondi e la manda al buffer del display usando *fbi*.

[Link allo script](https://github.com/Chris1sFlaggin/NAS/blob/main/script.py)

Successivamente ho creato dei cronjob per gestire il tutto.

---

## Implementazioni future

Il progetto è tutt’altro che concluso.  
Il mio obiettivo è continuare a migliorare il NAS per renderlo sempre più efficiente, completo e autonomo.  
Ecco alcune delle funzionalità che ho in programma:

### Backup automatici multipli
Implementare la regola **3-2-1** in modo completo:
- 3 copie dei dati (1 primaria + 2 backup)  
- 2 supporti diversi (HDD + SSD)  
- 1 copia off-site, magari sincronizzata su un server remoto tramite **rsync** o **rclone**.

### Dashboard di monitoraggio
Realizzare una **dashboard web** (con Grafana o un’app Flask leggera) per:
- visualizzare in tempo reale **temperatura, RAM, CPU e storage**
- mostrare lo stato dei container Docker
- inviare **notifiche Telegram** in caso di errori o disconnessioni.

### Automazioni e manutenzione
Sviluppare uno script periodico che:
- aggiorna automaticamente i container Docker  
- esegue un **check dei log**  
- invia un breve report giornaliero via email o Telegram.

### Proxy cache
Aggiungere un proxy cache per migliorare la velocità della rete domestica.

---

> 💭 Se hai idee o suggerimenti per migliorare il progetto, scrivimi pure su discord: _m9b3_0b20ck_.
